<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-0.10.1 plugin-docs plugin-id-default docs-doc-id-features/other/CyberML - Anomalous Access Detection">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">CyberML - Anomalous Access Detection | SynapseML</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" name="twitter:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="0.10.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.10.1"><meta data-rh="true" name="docsearch:version" content="0.10.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.10.1"><meta data-rh="true" property="og:title" content="CyberML - Anomalous Access Detection | SynapseML"><meta data-rh="true" name="description" content="Here we demonstrate a novel CyberML model which can learn user access patterns and then automatically detect anomalous user access based on learned behavior."><meta data-rh="true" property="og:description" content="Here we demonstrate a novel CyberML model which can learn user access patterns and then automatically detect anomalous user access based on learned behavior."><link data-rh="true" rel="icon" href="/SynapseML/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GBW8AA15RD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/SynapseML/blog/rss.xml" title="SynapseML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/SynapseML/blog/atom.xml" title="SynapseML Atom Feed">
<link rel="alternate" type="application/json" href="/SynapseML/blog/feed.json" title="SynapseML JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWPE0183E8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RWPE0183E8",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="SynapseML" href="/SynapseML/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/SynapseML/assets/css/styles.70cbcc49.css">
<link rel="preload" href="/SynapseML/assets/js/runtime~main.4b2bcca2.js" as="script">
<link rel="preload" href="/SynapseML/assets/js/main.c6c13a75.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like SynapseML, consider giving it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/SynapseML">GitHub</a> ⭐</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SynapseML/"><div class="navbar__logo"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SynapseML</b></a><a class="navbar__item navbar__link" href="/SynapseML/docs/about/">Docs</a><a class="navbar__item navbar__link" href="/SynapseML/blog/">Blog</a><a class="navbar__item navbar__link" href="/SynapseML/videos/">Videos</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/SynapseML/docs/0.10.1/about/">0.10.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/SynapseML/docs/next/features/other/CyberML - Anomalous Access Detection/">Next</a></li><li><a class="dropdown__link" href="/SynapseML/docs/features/other/CyberML - Anomalous Access Detection/">0.11.1</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.11.0/features/other/CyberML - Anomalous Access Detection/">0.11.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/">0.10.1</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.10.0/features/other/CyberML - Anomalous Access Detection/">0.10.0</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.9.5/features/other/CyberML - Anomalous Access Detection/">0.9.5</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.9.4/features/other/CyberML - Anomalous Access Detection/">0.9.4</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developer Docs</a><ul class="dropdown__menu"><li><a href="https://mmlspark.blob.core.windows.net/docs/0.11.1/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/0.11.1/scala/com/microsoft/azure/synapse/ml/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Scala<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/0.11.1/dotnet/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">C#<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SynapseML/docs/0.10.1/about/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/0.10.1/getting_started/installation/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/SynapseML/docs/0.10.1/features/cognitive_services/CognitiveServices - Analyze Text/">Features</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/cognitive_services/CognitiveServices - Analyze Text/">Cognitive Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/isolation_forest/IsolationForest - Multivariate Anomaly Detection/">Isolation Forest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/geospatial_services/GeospatialServices - Flooding Risk/">Geospatial Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/responsible_ai/Data Balance Analysis/">Responsible AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/onnx/about/">ONNX</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/lightgbm/about/">LightGBM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/vw/about/">Vowpal Wabbit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/spark_serving/about/">Spark Serving</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/opencv/OpenCV - Pipeline Image Transformations/">OpenCV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/classification/Classification - Adult Census with Vowpal Wabbit/">Classification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/regression/Regression - Auto Imports/">Regression</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/0.10.1/features/simple_deep_learning/about/">Simple Deep Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/AzureSearchIndex - Met Artworks/">Other</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/AzureSearchIndex - Met Artworks/">AzureSearchIndex - Met Artworks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/ConditionalKNN - Exploring Art Across Cultures/">ConditionalKNN - Exploring Art Across Cultures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/CyberML - Anomalous Access Detection/">CyberML - Anomalous Access Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/DeepLearning - BiLSTM Medical Entity Extraction/">DeepLearning - BiLSTM Medical Entity Extraction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/DeepLearning - CIFAR10 Convolutional Network/">DeepLearning - CIFAR10 Convolutional Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/DeepLearning - Flower Image Classification/">DeepLearning - Flower Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/DeepLearning - Transfer Learning/">DeepLearning - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/HyperParameterTuning - Fighting Breast Cancer/">HyperParameterTuning - Fighting Breast Cancer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/TextAnalytics - Amazon Book Reviews with Word2Vec/">TextAnalytics - Amazon Book Reviews with Word2Vec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/0.10.1/features/other/TextAnalytics - Amazon Book Reviews/">TextAnalytics - Amazon Book Reviews</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/0.10.1/documentation/transformers/transformers_cognitive/">Transformers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/0.10.1/documentation/estimators/estimators_cognitive/">Estimators</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/0.10.1/mlflow/introduction/">MLflow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/0.10.1/reference/developer-readme/">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->SynapseML<!-- --> <b>0.10.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/SynapseML/docs/features/other/CyberML - Anomalous Access Detection/">latest version</a></b> (<!-- -->0.11.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/SynapseML/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Features</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Other</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CyberML - Anomalous Access Detection</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.10.1</span><div class="theme-doc-markdown markdown"><h1>CyberML - Anomalous Access Detection</h1><p>Here we demonstrate a novel CyberML model which can learn user access patterns and then automatically detect anomalous user access based on learned behavior.
The model internally uses Collaborative Filtering for Implicit Feedback as published here: <a href="http://yifanhu.net/PUB/cf.pdf" target="_blank" rel="noopener noreferrer">http://yifanhu.net/PUB/cf.pdf</a>
and is based on Apache Spark&#x27;s implementation of this: <a href="https://spark.apache.org/docs/2.2.0/ml-collaborative-filtering.html" target="_blank" rel="noopener noreferrer">https://spark.apache.org/docs/2.2.0/ml-collaborative-filtering.html</a>.</p><p>This notebook demonstrates a usage example of Anomalous Resource Access model.
All the model requires is a dataset in which there are &#x27;users&#x27; which access &#x27;resources&#x27;.
The model is based on Collaborative Filtering and it uses Machine Learning to learn access patterns of users and resources.
When a user accesses a resource which is outside of the user&#x27;s learned profile then this access recieves a high anomaly score.</p><p>In this notebook we provide a usage example and a synthetic dataset in which there are 3 departments:
(1) Finance, (2) HR and (3) Engineering.
In the training data users access only a subset of resources from their own departments.
To evaluate the model we use two datasets.
The first contains access patterns unseen during training in which users access resources within their departments (again, resources they didn&#x27;t access during training but within their department).
The latter contains users accessing resources from outside their department.
We then use the model to assign anomaly scores expecting that the first get low anomaly scores and the latter recieve high anomaly scores.
This is what this example demonstrates.</p><p>Note: the data does NOT contain information about departments, this information is implictly learned by the model by analyzing the access patterns.</p><h1>Create an Azure Databricks cluster and install the following libs</h1><ol><li><p>In Cluster Libraries install from library source Maven:
Coordinates: com.microsoft.azure:synapseml_2.12:0.10.1
Repository: <a href="https://mmlspark.azureedge.net/maven" target="_blank" rel="noopener noreferrer">https://mmlspark.azureedge.net/maven</a></p></li><li><p>In Cluster Libraries install from PyPI the library called plotly</p></li></ol><h1>Setup &amp; Initialization</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># this is used to produce the synthetic dataset for this test</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">from synapse.ml.cyber.dataset import DataFactory</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># the access anomalies model generator</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">from synapse.ml.cyber.anomaly.collaborative_filtering import AccessAnomaly</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">from pyspark.sql import functions as f, types as t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">from pyspark.sql import SparkSession</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># Bootstrap Spark Session</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">spark = SparkSession.builder.getOrCreate()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Loadup datasets</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">from synapse.ml.core.platform import running_on_databricks</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">if running_on_databricks():</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    spark.sparkContext.setCheckpointDir(&quot;dbfs:/checkpoint_path/&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">else:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    spark.sparkContext.setCheckpointDir(&quot;/tmp/checkpoint_path/&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">factory = DataFactory(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_hr_users=25,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_hr_resources=50,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_fin_users=35,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_fin_resources=75,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_eng_users=15,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    num_eng_resources=25,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    single_component=True,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">training_pdf = factory.create_clustered_training_data(ratio=0.4)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># a tenant id is used when independant datasets originate from different tenants, in this example we set all tenants-ids to the same value</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">training_df = spark.createDataFrame(training_pdf).withColumn(&quot;tenant_id&quot;, f.lit(0))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">ingroup_df = spark.createDataFrame(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    factory.create_clustered_intra_test_data(training_pdf)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">).withColumn(&quot;tenant_id&quot;, f.lit(0))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">outgroup_df = spark.createDataFrame(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    factory.create_clustered_inter_test_data()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">).withColumn(&quot;tenant_id&quot;, f.lit(0))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">training_df.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">print(training_df.count())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">print(ingroup_df.count())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">print(outgroup_df.count())</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Model setup &amp; training</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">access_anomaly = AccessAnomaly(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    tenantCol=&quot;tenant_id&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    userCol=&quot;user&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    resCol=&quot;res&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    likelihoodCol=&quot;likelihood&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    maxIter=1000,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">model = access_anomaly.fit(training_df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Apply model &amp; show result stats</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ingroup_scored_df = model.transform(ingroup_df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ingroup_scored_df.agg(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.min(&quot;anomaly_score&quot;).alias(&quot;min_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.max(&quot;anomaly_score&quot;).alias(&quot;max_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.mean(&quot;anomaly_score&quot;).alias(&quot;mean_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.stddev(&quot;anomaly_score&quot;).alias(&quot;stddev_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">).show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">outgroup_scored_df = model.transform(outgroup_df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">outgroup_scored_df.agg(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.min(&quot;anomaly_score&quot;).alias(&quot;min_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.max(&quot;anomaly_score&quot;).alias(&quot;max_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.mean(&quot;anomaly_score&quot;).alias(&quot;mean_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    f.stddev(&quot;anomaly_score&quot;).alias(&quot;stddev_anomaly_score&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">).show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Examine results</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># Select a subset of results to send to Log Analytics</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">full_res_df = outgroup_scored_df.orderBy(f.desc(&quot;anomaly_score&quot;)).cache()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">from pyspark.sql.window import Window</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">w = Window.partitionBy(&quot;tenant_id&quot;, &quot;user&quot;, &quot;res&quot;).orderBy(f.desc(&quot;anomaly_score&quot;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># select values above threshold</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">results_above_threshold = full_res_df.filter(full_res_df.anomaly_score &gt; 1.0)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># get distinct resource/user and corresponding timestamp and highest score</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">results_to_la = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results_above_threshold.withColumn(&quot;index&quot;, f.row_number().over(w))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .orderBy(f.desc(&quot;anomaly_score&quot;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .select(&quot;tenant_id&quot;, f.col(&quot;user&quot;), f.col(&quot;res&quot;), &quot;anomaly_score&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .where(&quot;index == 1&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .limit(100)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .cache()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># add a fake timestamp to the results</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">results_to_la = results_to_la.withColumn(&quot;timestamp&quot;, f.current_timestamp())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">display(results_to_la)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Display all resource accesses by users with highest anomalous score</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">!pip install plotly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">from plotly import __version__</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">from plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot, offline</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">print(__version__)  # requires version &gt;= 1.9.0</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># run plotly in offline mode</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">offline.init_notebook_mode()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># Find all server accesses of users with high predicted scores</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># For display, limit to top 25 results</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">results_to_display = results_to_la.orderBy(f.desc(&quot;anomaly_score&quot;)).limit(25).cache()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">interesting_records = full_res_df.join(results_to_display, [&quot;user&quot;], &quot;left_semi&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">non_anomalous_records = interesting_records.join(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results_to_display, [&quot;user&quot;, &quot;res&quot;], &quot;left_anti&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">top_non_anomalous_records = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    non_anomalous_records.groupBy(&quot;tenant_id&quot;, &quot;user&quot;, &quot;res&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .agg(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        f.count(&quot;*&quot;).alias(&quot;count&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .select(f.col(&quot;tenant_id&quot;), f.col(&quot;user&quot;), f.col(&quot;res&quot;), &quot;count&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># pick only a subset of non-anomalous record for UI</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">w = Window.partitionBy(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    &quot;tenant_id&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    &quot;user&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">).orderBy(f.desc(&quot;count&quot;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># pick top non-anomalous set</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">top_non_anomalous_accesses = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    top_non_anomalous_records.withColumn(&quot;index&quot;, f.row_number().over(w))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .orderBy(f.desc(&quot;count&quot;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .select(&quot;tenant_id&quot;, f.col(&quot;user&quot;), f.col(&quot;res&quot;), f.col(&quot;count&quot;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .where(&quot;index in (1,2,3,4,5)&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .limit(25)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># add back anomalous record</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">fileShare_accesses = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    top_non_anomalous_accesses.select(&quot;user&quot;, &quot;res&quot;, &quot;count&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .union(results_to_display.select(&quot;user&quot;, &quot;res&quot;, f.lit(1).alias(&quot;count&quot;)))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .cache()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># get unique users and file shares</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">high_scores_df = fileShare_accesses.toPandas()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">unique_arr = np.append(high_scores_df.user.unique(), high_scores_df.res.unique())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">unique_df = pd.DataFrame(data=unique_arr, columns=[&quot;name&quot;])</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">unique_df[&quot;index&quot;] = range(0, len(unique_df.index))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># create index for source &amp; target and color for the normal accesses</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">normal_line_color = &quot;rgba(211, 211, 211, 0.8)&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">anomolous_color = &quot;red&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">x = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    pd.merge(high_scores_df, unique_df, how=&quot;left&quot;, left_on=&quot;user&quot;, right_on=&quot;name&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .drop([&quot;name&quot;], axis=1)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .rename(columns={&quot;index&quot;: &quot;userIndex&quot;})</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_index_df = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    pd.merge(x, unique_df, how=&quot;left&quot;, left_on=&quot;res&quot;, right_on=&quot;name&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .drop([&quot;name&quot;], axis=1)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .rename(columns={&quot;index&quot;: &quot;resIndex&quot;})</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_index_df[&quot;color&quot;] = normal_line_color</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># results_to_display index, color and</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">y = results_to_display.toPandas().drop(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    [&quot;tenant_id&quot;, &quot;timestamp&quot;, &quot;anomaly_score&quot;], axis=1</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">y = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    pd.merge(y, unique_df, how=&quot;left&quot;, left_on=&quot;user&quot;, right_on=&quot;name&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .drop([&quot;name&quot;], axis=1)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .rename(columns={&quot;index&quot;: &quot;userIndex&quot;})</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">high_scores_index_df = (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    pd.merge(y, unique_df, how=&quot;left&quot;, left_on=&quot;res&quot;, right_on=&quot;name&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .drop([&quot;name&quot;], axis=1)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    .rename(columns={&quot;index&quot;: &quot;resIndex&quot;})</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">high_scores_index_df[&quot;count&quot;] = 1</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">high_scores_index_df[&quot;color&quot;] = anomolous_color</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># substract 1 for the red entries in all_access df</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">hsi_df = high_scores_index_df[[&quot;user&quot;, &quot;res&quot;, &quot;count&quot;]].rename(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    columns={&quot;count&quot;: &quot;hsiCount&quot;}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_updated_count_df = pd.merge(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    all_access_index_df,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    hsi_df,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    how=&quot;left&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    left_on=[&quot;user&quot;, &quot;res&quot;],</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    right_on=[&quot;user&quot;, &quot;res&quot;],</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_updated_count_df[&quot;count&quot;] = np.where(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    all_access_updated_count_df[&quot;hsiCount&quot;] == 1,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    all_access_updated_count_df[&quot;count&quot;] - 1,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    all_access_updated_count_df[&quot;count&quot;],</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_updated_count_df = all_access_updated_count_df.loc[</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    all_access_updated_count_df[&quot;count&quot;] &gt; 0</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">]</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">all_access_updated_count_df = all_access_updated_count_df[</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    [&quot;user&quot;, &quot;res&quot;, &quot;count&quot;, &quot;userIndex&quot;, &quot;resIndex&quot;, &quot;color&quot;]</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">]</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># combine the two tables</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">frames = [all_access_updated_count_df, high_scores_index_df]</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">display_df = pd.concat(frames, sort=True)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># display_df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">data_trace = dict(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    type=&quot;sankey&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    domain=dict(x=[0, 1], y=[0, 1]),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    orientation=&quot;h&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    valueformat=&quot;.0f&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    node=dict(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        pad=10,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        thickness=30,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        line=dict(color=&quot;black&quot;, width=0),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        label=unique_df[&quot;name&quot;].dropna(axis=0, how=&quot;any&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    link=dict(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        source=display_df[&quot;userIndex&quot;].dropna(axis=0, how=&quot;any&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        target=display_df[&quot;resIndex&quot;].dropna(axis=0, how=&quot;any&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        value=display_df[&quot;count&quot;].dropna(axis=0, how=&quot;any&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        color=display_df[&quot;color&quot;].dropna(axis=0, how=&quot;any&quot;),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">layout = dict(</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    title=&quot;All resources accessed by users with highest anomalous scores&quot;,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    height=772,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    font=dict(size=10),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">fig = dict(data=[data_trace], layout=layout)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">p = plot(fig, output_type=&quot;div&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">if running_on_databricks():</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    displayHTML(p)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">else:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    import IPython</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    IPython.display.HTML(p)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/SynapseML/docs/0.10.1/features/other/ConditionalKNN - Exploring Art Across Cultures/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ConditionalKNN - Exploring Art Across Cultures</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SynapseML/docs/0.10.1/features/other/DeepLearning - BiLSTM Medical Entity Extraction/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DeepLearning - BiLSTM Medical Entity Extraction</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/first_example/">Getting Started</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.11.1/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python API Reference</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.11.1/scala/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scala API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/videos/">Videos</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Microsoft.</div></div></div></footer></div>
<script src="/SynapseML/assets/js/runtime~main.4b2bcca2.js"></script>
<script src="/SynapseML/assets/js/main.c6c13a75.js"></script>
</body>
</html>